<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Watering App</title>
</head>
<body>

    <!-- Image to send -->
    <img id="photo" src="rose.png" alt="Captured Photo" style="display:none;">

    <button id="analyzeButton">Analyze Flower</button>

    <script>
        // Function to handle the request and use CORS proxy
        async function analyzeFlower() {
            const apiUrl = 'https://my-api.plantnet.org/v2/identify/all?include-related-images=false&no-reject=false&nb-results=10&lang=en&api-key=2b10lKE5W6Q5K5ajPWxctu7qe';
            const corsProxyUrl = 'https://cors-anywhere.herokuapp.com/'; // Temporary CORS proxy

            const image = document.getElementById('photo'); // Static image from the same folder
            const imageUrl = image.src; // Image URL

            // Fetch image as Blob
            const response = await fetch(imageUrl);
            const imageBlob = await response.blob();

            // Prepare the FormData for sending as multipart/form-data
            const formData = new FormData();
            formData.append('images', imageBlob, 'rose.png'); // Add image blob to formData

            // Sending the fetch request using the CORS proxy
            const fetchResponse = await fetch(corsProxyUrl + apiUrl, {
                method: 'POST',
                headers: {
                    'accept': 'application/json',
                },
                body: formData
            });

            // Handle the response
            if (!fetchResponse.ok) {
                const errorText = await fetchResponse.text();
                throw new Error(`API error: ${fetchResponse.status} - ${errorText}`);
            }

            const result = await fetchResponse.json();
            console.log(result); // You can process the result further here
            alert('Flower analyzed! Check console for result.');
        }

        // Add event listener to analyze button
        document.getElementById('analyzeButton').addEventListener('click', analyzeFlower);
    </script>
</body>
</html>
